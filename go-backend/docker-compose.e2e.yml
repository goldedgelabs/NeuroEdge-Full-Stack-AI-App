
version: '3.8'
services:
  postgres:
    image: postgres:15-alpine
    environment:
      - POSTGRES_USER=neuro
      - POSTGRES_PASSWORD=neuro
      - POSTGRES_DB=neuroedge
    ports: ['5432:5432']

  redis:
    image: redis:7-alpine
    ports: ['6379:6379']

  otel-collector:
    image: otel/opentelemetry-collector-contrib:0.78.0
    command: ["--config=/etc/otel-collector-config.yaml"]
    volumes:
      - ./otel/collector-config.yaml:/etc/otel-collector-config.yaml:ro
    ports: ['4318:4318']

  go-backend:
    build: .
    environment:
      - POSTGRES_URL=postgres://neuro:neuro@postgres:5432/neuroedge
      - REDIS_URL=redis://redis:6379
      - OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
    depends_on:
      - postgres
      - redis
      - otel-collector
    ports: ['9000:9000']

  python-backend:
    image: python:3.11-slim
    command: ["sleep", "infinity"]
    ports: ['8000:8000']

  ts-backend:
    image: node:18-alpine
    command: ["sleep", "infinity"]
    ports: ['3000:3000']
